# IP-Adapter-for-Weed-Detection
This is the official repo for the paper "Image Prompt Adapter-Based Stable Diffusion for Enhanced Multi-Class Weed Generation and Detection". 
This study presents a novel investigation of advanced stable diffusion integrated with a module with image prompt capability, IP-Adapter, for weed image generation, thereby enhancing weed detection. 
The combination of synthetic data, generated by the IP-adpater-based stable diffusion, with real-world data, achieve an improved mAP@50:95 of 1.26% over by only using real-world images.

The weed dataset used in this study is publicly available at https://doi.org/10.5281/zenodo.14861516, comprising a total of 8436 images and 27,963 annotated instances across 10 weed classes.

## Citation
Please consider cite our work if you find this repo is helpful.
```
@article{
  title={Image Prompt Adapter-Based Stable Diffusion for Enhanced Multi-Class Weed Generation and Detection},
  author={Lu, Yuzhen and Deng, Boyang},
  journal={AgriEngineering},
  volume={7},
  pages={389},
  year={2025},
  publisher={MDPI}
}
```

## Contents

1) The ComfyUI code used for developping workflow to generate synthetic images. Modified from https://github.com/comfyanonymous/ComfyUI
2) The Detection code used for training the weed detection model based on https://github.com/ultralytics/ultralytics
3) The ImageQualityMetrics code used for assesssing the FID/IS of synthetic images.
4) The IP-Adapter code used for training the weed generation model.Modified from https://github.com/tencent-ailab/IP-Adapter
